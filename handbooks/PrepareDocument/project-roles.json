{
  "meta": {
    "generated_at": "2025-10-10T00:00:00Z",
    "generator": "Trae Assistant (manual JSON)",
    "project_root": "bakerfi-contracts",
    "note": "依据仓库结构直接定义目录与文件角色；包含规则与关键条目，覆盖所有模块类型。"
  },
  "role_rules": [
    {"pattern": "audits/stage2/**", "role": "阶段2审计资料与索引", "description": "审计阶段方法、系统结构、标准映射、可信源、运行说明"},
    {"pattern": "audits/**.pdf", "role": "外部审计报告", "description": "第三方审计PDF"},
    {"pattern": "constants/*.ts", "role": "常量与网络配置", "description": "部署/脚本使用的常量、网络配置、账户与选择器"},
    {"pattern": "constants/selectors.json", "role": "函数选择器映射", "description": "Solidity函数选择器/接口映射"},
    {"pattern": "contracts/core/**.sol", "role": "核心合约实现", "description": "Vault/Router/Strategy等核心逻辑与基类"},
    {"pattern": "contracts/core/flashloan/**.sol", "role": "闪电贷适配器", "description": "Balancer等闪电贷能力"},
    {"pattern": "contracts/core/governance/**.sol", "role": "治理模块", "description": "治理代币、Governor、Timelock"},
    {"pattern": "contracts/core/hooks/**.sol", "role": "功能钩子/辅助模块", "description": "外部协议交互、授权、报价器等"},
    {"pattern": "contracts/core/hooks/swappers/**.sol", "role": "交换路由适配器", "description": "统一或协议特定的代币交换"},
    {"pattern": "contracts/core/router/**.sol", "role": "命令路由", "description": "组合/调度命令执行"},
    {"pattern": "contracts/core/strategies/**.sol", "role": "策略实现", "description": "杠杆/存款/交换等策略逻辑"},
    {"pattern": "contracts/interfaces/**.sol", "role": "外部接口声明", "description": "AAVE、Curve、Uniswap、Chainlink、Pyth等接口"},
    {"pattern": "contracts/libraries/**.sol", "role": "库与数学工具", "description": "复合计算、重基、协议工具库"},
    {"pattern": "contracts/mocks/**.sol", "role": "测试/模拟合约", "description": "协议模拟、攻击者、路由器等Mock"},
    {"pattern": "contracts/oracles/**.sol", "role": "喂价与汇率预言机", "description": "Chainlink、Pyth、比率预言机实现"},
    {"pattern": "contracts/proxy/**.sol", "role": "代理与管理员", "description": "可升级代理与管理控制"},
    {"pattern": "contracts/tests/**.sol", "role": "Solidity测试样例", "description": "基础测试示例"},
    {"pattern": "doc/**.md", "role": "模块文档", "description": "与contracts对应的中文/英文说明文档"},
    {"pattern": "handbooks/**", "role": "手册与方法论", "description": "项目目标、方法论、实例、准备文档、术语等"},
    {"pattern": "scripts/tasks/**.ts", "role": "Hardhat任务定义", "description": "任务注册与子命令"},
    {"pattern": "scripts/**.ts", "role": "部署/操作/升级脚本", "description": "部署与升级、验证、存取操作"},
    {"pattern": "scripts/**.sh", "role": "辅助Shell脚本", "description": "模型/构建等辅助"},
    {"pattern": "src/contracts/**", "role": "TypeChain类型与封装", "description": "合约TS封装与接口"},
    {"pattern": "src/types/**", "role": "第三方类型库", "description": "OpenZeppelin、Morpho Blue等TS类型"},
    {"pattern": "test/**", "role": "Hardhat测试套件", "description": "单元/集成测试"},
    {"pattern": "*.yaml", "role": "工具配置", "description": "Echidna/Tenderly等配置"},
    {"pattern": "slither.config.json", "role": "Slither静态分析配置", "description": "静态分析工具配置"},
    {"pattern": "hardhat.config.ts", "role": "Hardhat配置", "description": "编译、网络、插件与任务"},
    {"pattern": "package.json", "role": "NPM清单与脚本", "description": "依赖与命令"},
    {"pattern": "package-lock.json", "role": "锁定依赖版本", "description": "NPM锁文件"},
    {"pattern": "tsconfig.json", "role": "TypeScript配置", "description": "编译选项"},
    {"pattern": "README.md", "role": "项目总览", "description": "顶层说明"},
    {"pattern": "LICENSE", "role": "许可协议", "description": "MIT/Apache等许可"},
    {"pattern": "SECURITY.md", "role": "安全政策", "description": "披露与报告指南"},
    {"pattern": "CODE_OF_CONDUCT.md", "role": "行为准则", "description": "贡献者行为规范"},
    {"pattern": "CONTRIBUTING.md", "role": "贡献指南", "description": "开发与提交流程"},
    {"pattern": "MARKETS.md", "role": "市场/网络说明", "description": "支持网络/市场说明"},
    {"pattern": "RELEASE_NOTES.md", "role": "发布说明", "description": "版本更新记录"},
    {"pattern": "TASKS.md", "role": "任务概览", "description": "开发/运维任务说明"},
    {"pattern": "funding.json", "role": "资助/资金配置", "description": "资金或激励相关配置"},
    {"pattern": "mappings.json", "role": "映射配置", "description": "选择器/地址/名称映射"},
    {"pattern": "src/contract-selectors.json", "role": "合约选择器清单", "description": "函数选择器集合"}
  ],
  "entries": [
    {"path": "README.md", "type": "file", "role": "项目总览"},
    {"path": "hardhat.config.ts", "type": "file", "role": "Hardhat配置"},
    {"path": "package.json", "type": "file", "role": "NPM清单与脚本"},
    {"path": "package-lock.json", "type": "file", "role": "锁定依赖版本"},
    {"path": "tsconfig.json", "type": "file", "role": "TypeScript配置"},
    {"path": "echidna.yaml", "type": "file", "role": "Echidna配置"},
    {"path": "tenderly.yaml", "type": "file", "role": "Tenderly配置"},
    {"path": "slither.config.json", "type": "file", "role": "Slither静态分析配置"},
    {"path": "LICENSE", "type": "file", "role": "许可协议"},
    {"path": "SECURITY.md", "type": "file", "role": "安全政策"},
    {"path": "CODE_OF_CONDUCT.md", "type": "file", "role": "行为准则"},
    {"path": "CONTRIBUTING.md", "type": "file", "role": "贡献指南"},
    {"path": "MARKETS.md", "type": "file", "role": "市场/网络说明"},
    {"path": "RELEASE_NOTES.md", "type": "file", "role": "发布说明"},
    {"path": "TASKS.md", "type": "file", "role": "任务概览"},
    {"path": "funding.json", "type": "file", "role": "资助/资金配置"},
    {"path": "mappings.json", "type": "file", "role": "映射配置"},

    {"path": "audits", "type": "directory", "role": "审计资料"},
    {"path": "audits/audit-creed-2024-05-10.pdf", "type": "file", "role": "外部审计报告"},
    {"path": "audits/stage2", "type": "directory", "role": "阶段2审计资料与索引"},
    {"path": "audits/stage2/invariants/README.md", "type": "file", "role": "不变式说明"},
    {"path": "audits/stage2/run_test.md", "type": "file", "role": "运行测试说明"},
    {"path": "audits/stage2/stage2_index.md", "type": "file", "role": "阶段2索引"},
    {"path": "audits/stage2/stage2_to_stage3_index.md", "type": "file", "role": "阶段2到阶段3映射"},
    {"path": "audits/stage2/standard_mapping.csv", "type": "file", "role": "标准映射CSV"},
    {"path": "audits/stage2/standard_mapping.json", "type": "file", "role": "标准映射JSON"},
    {"path": "audits/stage2/system_structure.md", "type": "file", "role": "系统结构说明"},
    {"path": "audits/stage2/trust_sources.md", "type": "file", "role": "可信源登记"},

    {"path": "constants", "type": "directory", "role": "常量与网络配置"},
    {"path": "constants/contracts.ts", "type": "file", "role": "合约地址/常量"},
    {"path": "constants/network-deploy-config.ts", "type": "file", "role": "网络部署配置"},
    {"path": "constants/pyth.ts", "type": "file", "role": "Pyth相关常量"},
    {"path": "constants/selectors.json", "type": "file", "role": "函数选择器映射"},
    {"path": "constants/test-accounts.ts", "type": "file", "role": "测试账户"},
    {"path": "constants/types.ts", "type": "file", "role": "类型定义"},

    {"path": "contracts", "type": "directory", "role": "Solidity源码"},
    {"path": "contracts/core", "type": "directory", "role": "核心合约"},
    {"path": "contracts/core/Vault.sol", "type": "file", "role": "金库主合约"},
    {"path": "contracts/core/VaultBase.sol", "type": "file", "role": "金库基类"},
    {"path": "contracts/core/VaultRouter.sol", "type": "file", "role": "路由器"},
    {"path": "contracts/core/MultiStrategyVault.sol", "type": "file", "role": "多策略金库"},
    {"path": "contracts/core/MultiStrategy.sol", "type": "file", "role": "多策略聚合"},
    {"path": "contracts/core/MultiCommand.sol", "type": "file", "role": "命令聚合"},
    {"path": "contracts/core/VaultRegistry.sol", "type": "file", "role": "金库注册表"},
    {"path": "contracts/core/VaultSettings.sol", "type": "file", "role": "金库参数"},
    {"path": "contracts/core/Constants.sol", "type": "file", "role": "常量定义"},
    {"path": "contracts/core/EmptySlot.sol", "type": "file", "role": "存储槽工具"},
    {"path": "contracts/core/governance/BKR.sol", "type": "file", "role": "治理代币"},
    {"path": "contracts/core/governance/BakerFiGovernor.sol", "type": "file", "role": "治理合约"},
    {"path": "contracts/core/governance/Timelock.sol", "type": "file", "role": "时间锁"},
    {"path": "contracts/core/flashloan/BalancerFlashLender.sol", "type": "file", "role": "Balancer闪电贷"},
    {"path": "contracts/core/router/Commands.sol", "type": "file", "role": "命令定义"},
    {"path": "contracts/core/hooks/UseAAVEv3.sol", "type": "file", "role": "AAVEv3钩子"},
    {"path": "contracts/core/hooks/UseOracle.sol", "type": "file", "role": "预言机钩子"},
    {"path": "contracts/core/hooks/swappers/UseUnifiedSwapper.sol", "type": "file", "role": "统一交换器"},
    {"path": "contracts/core/strategies/StrategyLeverage.sol", "type": "file", "role": "杠杆策略"},
    {"path": "contracts/core/strategies/StrategySupplyMorpho.sol", "type": "file", "role": "Morpho供给策略"},

    {"path": "contracts/interfaces", "type": "directory", "role": "外部接口"},
    {"path": "contracts/libraries", "type": "directory", "role": "库"},
    {"path": "contracts/mocks", "type": "directory", "role": "模拟与测试"},
    {"path": "contracts/oracles", "type": "directory", "role": "预言机"},
    {"path": "contracts/proxy", "type": "directory", "role": "代理与管理员"},
    {"path": "contracts/tests", "type": "directory", "role": "Solidity测试样例"},

    {"path": "doc", "type": "directory", "role": "模块文档"},
    {"path": "doc/README.md", "type": "file", "role": "文档索引"},
    {"path": "doc/architecture.png", "type": "file", "role": "架构图"},
    {"path": "doc/core/Vault.md", "type": "file", "role": "金库文档"},
    {"path": "doc/core/VaultRouter.md", "type": "file", "role": "路由器文档"},
    {"path": "doc/core/flashloan/BalancerFlashLender.md", "type": "file", "role": "闪电贷文档"},
    {"path": "doc/core/strategies/StrategyLeverage.md", "type": "file", "role": "策略文档"},
    {"path": "doc/interfaces/aave/v3/IPoolV3.md", "type": "file", "role": "AAVE接口文档"},
    {"path": "doc/libraries/MathLibrary.md", "type": "file", "role": "数学库文档"},
    {"path": "doc/proxy/BakerFiProxy.md", "type": "file", "role": "代理文档"},
    {"path": "doc/storage-compatibility.md", "type": "file", "role": "存储兼容性文档"},

    {"path": "handbooks", "type": "directory", "role": "手册与方法论"},
    {"path": "handbooks/Default/不成熟的想法-阶段1.md", "type": "file", "role": "阶段1需求"},
    {"path": "handbooks/Default/不成熟的想法-阶段2.md", "type": "file", "role": "阶段2需求"},
    {"path": "handbooks/Default/不成熟的想法-阶段3.md", "type": "file", "role": "阶段3需求"},
    {"path": "handbooks/ProjectObjective/README.md", "type": "file", "role": "项目目标与阶段对齐"},
    {"path": "handbooks/PrepareDocument/README.md", "type": "file", "role": "准备文档说明"},
    {"path": "handbooks/PrepareDocument/keywords.json", "type": "file", "role": "项目术语词典"},

    {"path": "scripts", "type": "directory", "role": "部署/任务脚本"},
    {"path": "scripts/cli.ts", "type": "file", "role": "命令行入口"},
    {"path": "scripts/deploy.ts", "type": "file", "role": "通用部署"},
    {"path": "scripts/deploy-dev.ts", "type": "file", "role": "开发环境部署"},
    {"path": "scripts/deploy-multistrategy-dev.ts", "type": "file", "role": "多策略部署"},
    {"path": "scripts/deploy-router.ts", "type": "file", "role": "路由部署"},
    {"path": "scripts/deploy-bkr.ts", "type": "file", "role": "治理代币部署"},
    {"path": "scripts/upgrade-v1.1.0.ts", "type": "file", "role": "升级脚本"},
    {"path": "scripts/upgrade-oracles.ts", "type": "file", "role": "预言机升级"},
    {"path": "scripts/upgrade-mille-feuille.ts", "type": "file", "role": "多层升级"},
    {"path": "scripts/upgrade-saphine-tartellete.ts", "type": "file", "role": "特定版本升级"},
    {"path": "scripts/verify.ts", "type": "file", "role": "Etherscan验证"},
    {"path": "scripts/deposit.ts", "type": "file", "role": "金库存款操作"},
    {"path": "scripts/lib/contract-client.ts", "type": "file", "role": "合约客户端封装"},
    {"path": "scripts/tasks/index.ts", "type": "file", "role": "任务索引"},
    {"path": "scripts/tasks/vault.ts", "type": "file", "role": "金库任务"},
    {"path": "scripts/tasks/router.ts", "type": "file", "role": "路由任务"},
    {"path": "scripts/tasks/oracles.ts", "type": "file", "role": "预言机任务"},
    {"path": "scripts/tasks/settings.ts", "type": "file", "role": "参数任务"},
    {"path": "scripts/tasks/strategy.ts", "type": "file", "role": "策略任务"},
    {"path": "scripts/tasks/token.ts", "type": "file", "role": "代币任务"},

    {"path": "src", "type": "directory", "role": "TypeScript源码与类型"},
    {"path": "src/index.ts", "type": "file", "role": "入口导出"},
    {"path": "src/common.ts", "type": "file", "role": "通用工具"},
    {"path": "src/contract-selectors.json", "type": "file", "role": "函数选择器清单"},
    {"path": "src/contracts/core/Vault.ts", "type": "file", "role": "金库TS封装"},
    {"path": "src/contracts/core/VaultRouter.ts", "type": "file", "role": "路由TS封装"},
    {"path": "src/contracts/core/strategies/StrategyLeverage.ts", "type": "file", "role": "策略TS封装"},
    {"path": "src/interfaces/core/IVault.ts", "type": "file", "role": "金库接口TS"},
    {"path": "src/libraries/MathLibrary.ts", "type": "file", "role": "数学库TS"},

    {"path": "test", "type": "directory", "role": "测试"},
    {"path": "test/common.ts", "type": "file", "role": "测试公共工具"},
    {"path": "test/core/vault/Vault.ts", "type": "file", "role": "金库单元测试"},
    {"path": "test/core/strategies/StrategySupplyERC4626.ts", "type": "file", "role": "策略单元测试"},
    {"path": "test/hooks/UseTokenActions.test.ts", "type": "file", "role": "钩子测试"},
    {"path": "test/oracles/ExRateOracle.ts", "type": "file", "role": "预言机测试"},
    {"path": "test/proxy/VaultProxy.ts", "type": "file", "role": "代理测试"}
  ],
  "determination": {
    "method": "规则优先 + 关键条目列举",
    "coverage": "规则覆盖所有文件类型；关键条目示例覆盖每个模块与目录",
    "how_to_use": "若某路径未在entries显式列举，则按role_rules中pattern匹配赋予角色。"
  }
}